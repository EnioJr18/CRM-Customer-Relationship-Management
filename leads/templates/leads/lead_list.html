{% extends "leads/base.html" %}

{% block content %}
<div class="container-fluid">

    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2 class="fw-bold text-white">Meus Leads</h2>
        
        <div class="d-flex gap-2">
            <form class="d-flex" role="search" action="{% url 'leads:lead_search' %}" method="GET">
                <input class="form-control me-2" type="search" name="q" placeholder="Buscar lead..." aria-label="Search" 
                       style="background: var(--bg-card); border: 1px solid rgba(255,255,255,0.1); color: white;">
                <button class="btn btn-outline-light" type="submit"><i class="bi bi-search"></i></button>
            </form>
            
            <a href="{% url 'leads:lead_create' %}" class="btn" style="background-color: var(--accent-color); color: white;">
                <i class="bi bi-plus-lg"></i> Novo
            </a>
        </div>
    </div>

    <div class="card-dashboard p-0">
        <div class="table-responsive">
            <table class="table table-dark-custom align-middle mb-0">
                <thead>
                    <tr>
                        <th>Nome</th>
                        <th>Email / Telefone</th>
                        <th>Status</th>
                        <th>Prioridade</th>
                        <th class="text-end">Ações</th>
                    </tr>
                </thead>
                <tbody>
                    {% for lead in leads %}
                    <tr>
                        <td>
                            <div class="d-flex align-items-center">
                                <div class="rounded-circle d-flex align-items-center justify-content-center me-3" 
                                     style="width: 40px; height: 40px; background-color: rgba(139, 92, 246, 0.2); color: #8b5cf6; font-weight: bold;">
                                    {{ lead.nome|first }}{{ lead.sobrenome|default:""|first }}
                                </div>
                                <div>
                                    <span class="d-block text-white fw-bold">{{ lead.nome }} {{ lead.sobrenome }}</span>
                                    <small class="text-secondary">Adicionado em {{ lead.criado_em|date:"d/m/Y" }}</small>
                                </div>
                            </div>
                        </td>
                        <td>
                            <div class="d-flex flex-column">
                                <span class="text-white small"><i class="bi bi-envelope me-2"></i>{{ lead.email }}</span>
                                <span class="text-secondary small"><i class="bi bi-telephone me-2"></i>{{ lead.telefone }}</span>
                            </div>
                        </td>
                        <td>
                            <span class="badge rounded-pill border border-secondary text-secondary">
                                {{ lead.get_status_display }}
                            </span>
                        </td>
                        <td>
                            {% if lead.prioridade == 'alta' %}
                                <span class="text-danger small fw-bold"><i class="bi bi-arrow-up-circle-fill"></i> Alta</span>
                            {% elif lead.prioridade == 'media' %}
                                <span class="text-warning small fw-bold"><i class="bi bi-dash-circle"></i> Média</span>
                            {% else %}
                                <span class="text-success small fw-bold"><i class="bi bi-arrow-down-circle"></i> Baixa</span>
                            {% endif %}
                        </td>
                        <td class="text-end">
                            <a href="{% url 'leads:lead_detail' lead.pk %}" class="btn btn-sm btn-outline-light">
                                <i class="bi bi-eye"></i> Detalhes
                            </a>
                        </td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="5" class="text-center py-5">
                            <i class="bi bi-inbox fs-1 text-secondary d-block mb-3"></i>
                            <p class="text-secondary">Nenhum lead encontrado.</p>
                            <a href="{% url 'leads:lead_create' %}" class="btn btn-sm btn-outline-primary">Cadastre o primeiro</a>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>
{% endblock %}